var glslRadixSortCountQuad = `
{
	uint base = {i}u * 4u;
	uvec4 mi4 = (keyIndex + base) + QUAD_OFFSETS;
	#ifdef SOURCE_LINEAR
		uvec4 y4 = mi4 / uint(sw);
		uvec4 x4 = mi4 - y4 * uint(sw);
		uvec4 keys = uvec4(
			texelFetch(keysTexture, ivec2(x4.x, y4.x), 0).r,
			texelFetch(keysTexture, ivec2(x4.y, y4.y), 0).r,
			texelFetch(keysTexture, ivec2(x4.z, y4.z), 0).r,
			texelFetch(keysTexture, ivec2(x4.w, y4.w), 0).r
		);
	#else
		uvec4 keys = uvec4(
			texelFetch(keysTexture, indexToUV(mi4.x), 0).r,
			texelFetch(keysTexture, indexToUV(mi4.y), 0).r,
			texelFetch(keysTexture, indexToUV(mi4.z), 0).r,
			texelFetch(keysTexture, indexToUV(mi4.w), 0).r
		);
	#endif
	uvec4 digits = (keys >> cBit) & mask4;
	uvec4 m4 = uvec4(equal(digits, digitIdx4));
	#ifdef BOUNDS_CHECK
		m4 *= uvec4(lessThan(mi4, elemCount4));
	#endif
	count += m4.x + m4.y + m4.z + m4.w;
}
`;

export { glslRadixSortCountQuad as default };
