var wgslRadixSortCountQuad = `
{
	let base = {i}u * 4u;
	var mi4 = (keyIndex + base) + QUAD_OFFSETS;
	#ifdef SOURCE_LINEAR
		var y4 = vec4i(mi4) / sw;
		var x4 = vec4i(mi4) - y4 * sw;
		var keys = vec4u(
			textureLoad(keysTexture, vec2i(x4.x, y4.x), 0).r,
			textureLoad(keysTexture, vec2i(x4.y, y4.y), 0).r,
			textureLoad(keysTexture, vec2i(x4.z, y4.z), 0).r,
			textureLoad(keysTexture, vec2i(x4.w, y4.w), 0).r
		);
	#else
		var keys = vec4u(
			textureLoad(keysTexture, indexToUV(mi4.x), 0).r,
			textureLoad(keysTexture, indexToUV(mi4.y), 0).r,
			textureLoad(keysTexture, indexToUV(mi4.z), 0).r,
			textureLoad(keysTexture, indexToUV(mi4.w), 0).r
		);
	#endif
	var digits = (keys >> vec4u(cBit)) & mask4;
	var m4 = select(vec4u(0u), vec4u(1u), digits == digitIdx4);
	#ifdef BOUNDS_CHECK
		m4 = select(m4, vec4u(0u), mi4 >= elemCount4);
	#endif
	count += m4.x + m4.y + m4.z + m4.w;
}
`;

export { wgslRadixSortCountQuad as default };
